<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>Jmeter | K&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">nimingkun&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/app">App</a>
                
                    <a class="menu-item" href="/map">Map</a>
                
                    <a class="menu-item" href="/game">Game</a>
                
                    <a class="menu-item" href="/media">Media</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">nimingkun&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/app">App</a>
                
                    <a class="menu-item" href="/map">Map</a>
                
                    <a class="menu-item" href="/game">Game</a>
                
                    <a class="menu-item" href="/media">Media</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Jmeter</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">nmk</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">2021-3-27&nbsp;&nbsp;14:05:00</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>Apache JMeter是Apache组织开发的基于Java的压力测试工具.它可以用于测试静态和动态资源，例如静态文件、Java 小服务程序、CGI 脚本、Java 对象、数据库、FTP 服务器， 等等。JMeter 可以用于对服务器、网络或对象模拟巨大的负载，来自不同压力类别下测试它们的强度和分析整体性能。另外，JMeter能够对应用程序做功能/回归测试，通过创建带有断言的脚本来验证你的程序返回了你期望的结果。为了最大限度的灵活性，JMeter允许使用正则表达式创建断言。<br><strong>Jmeter的作用</strong><br>1.能够对HTTP和FTP服务器进行压力和性能测试， 也可以对任何数据库进行同样的测试（通过JDBC）。<br>2.完全的可移植性和100% 纯java。<br>3.完全 Swing 和轻量组件支持（预编译的JAR使用 javax.swing.<em>)包。<br>4.完全多线程 框架允许通过多个线程并发取样和 通过单独的线程组对不同的功能同时取样。<br>5.精心的GUI设计允许快速操作和更精确的计时。<br>6.缓存和离线分析/回放测试结果。<br>*</em>JMeter的高可扩展性**<br>1.可链接的取样器允许无限制的测试能力。<br>2.各种负载统计表和可链接的计时器可供选择。<br>3.数据分析和可视化插件提供了很好的可扩展性以及个性化。<br>4.具有提供动态输入到测试的功能（包括Javascript）。<br>5.支持脚本编程的取样器（在1.9.2及以上版本支持BeanShell）。</p>
<p><strong>JDK</strong></p>
<p>Jmeter使用,需要依赖JDK1.8,可前往官网进行下载</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">归档版:</span><br><span class="line">https:<span class="regexp">//</span>www.oracle.com<span class="regexp">/java/</span>technologies<span class="regexp">/javase/</span>javase8-archive-downloads.html</span><br><span class="line"><span class="comment">#最好不采用最新版本的JDK进行使用</span></span><br></pre></td></tr></table></figure>

<p>这里使用自己下载好的下载链接</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http<span class="variable">s:</span>//nmk0718.<span class="keyword">com</span>.<span class="keyword">com</span>/jdk/jdk-<span class="number">8</span>u181-windows-x64.<span class="keyword">exe</span></span><br><span class="line">http<span class="variable">s:</span>//nmk0718.<span class="keyword">com</span>.<span class="keyword">com</span>/jdk/jdk-<span class="number">8</span>u181-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>

<p>windows安装JDK</p>
<p>双击下载好的exe一直下一步即可</p>
<p>配置环境变量:右键我的电脑&gt;属性&gt;高级系统设置&gt;环境变量</p>
<img src="\image\image-20210319105114950.png">

<p>新增用户变量</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">变量名:JAVA_HOME</span><br><span class="line">变量值:<span class="symbol">C:</span>\Program Files\Java\jdk1.<span class="number">8.0_181</span></span><br><span class="line"></span><br><span class="line">变量名:CLASSPATH</span><br><span class="line">变量值:.;%JAVA_HOME%\<span class="class"><span class="keyword">lib</span>\<span class="title">dt</span>.<span class="title">jar</span>;</span>%JAVA_HOME%\<span class="class"><span class="keyword">lib</span>\<span class="title">tools</span>.<span class="title">jar</span></span></span><br><span class="line"></span><br><span class="line">变量名:Path</span><br><span class="line">变量值:%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;</span><br></pre></td></tr></table></figure>

<p>通过cmd查看是否已经配置完成</p>
<img src="\image\image-20210319105859901.png">

<p>linux安装JDK</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@centos ~]</span># <span class="selector-tag">cd</span> /<span class="selector-tag">usr</span>/<span class="selector-tag">local</span>/</span><br><span class="line"><span class="selector-attr">[root@centos local]</span># <span class="selector-tag">wget</span> <span class="selector-tag">https</span>:<span class="comment">//nmk0718.com.com/jdk/jdk-8u181-linux-x64.tar.gz</span></span><br><span class="line"><span class="selector-tag">--2021-03-19</span> <span class="selector-tag">11</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:06--</span>  <span class="selector-tag">https</span>:<span class="comment">//nmk0718.com.com/jdk/jdk-8u181-linux-x64.tar.gz</span></span><br><span class="line"><span class="selector-tag">Resolving</span> <span class="selector-tag">nmk0718</span><span class="selector-class">.com</span><span class="selector-class">.com</span> (nmk0718.com.com)... <span class="selector-tag">119</span><span class="selector-class">.130</span><span class="selector-class">.113</span><span class="selector-class">.242</span></span><br><span class="line"><span class="selector-tag">Connecting</span> <span class="selector-tag">to</span> <span class="selector-tag">nmk0718</span><span class="selector-class">.com</span><span class="selector-class">.com</span> (nmk0718.com.com)|<span class="selector-tag">119</span><span class="selector-class">.130</span><span class="selector-class">.113</span><span class="selector-class">.242</span>|<span class="selector-pseudo">:443...</span> <span class="selector-tag">connected</span>.</span><br><span class="line"><span class="selector-tag">HTTP</span> <span class="selector-tag">request</span> <span class="selector-tag">sent</span>, <span class="selector-tag">awaiting</span> <span class="selector-tag">response</span>... <span class="selector-tag">200</span> <span class="selector-tag">OK</span></span><br><span class="line"><span class="selector-tag">Length</span>: <span class="selector-tag">185646832</span> (<span class="number">177</span>M) <span class="selector-attr">[application/octet-stream]</span></span><br><span class="line"><span class="selector-tag">Saving</span> <span class="selector-tag">to</span>: ‘<span class="selector-tag">jdk-8u181-linux-x64</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span>’</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">100%</span><span class="selector-attr">[================================================================================================================================================================&gt;]</span> <span class="selector-tag">185</span>,<span class="selector-tag">646</span>,<span class="selector-tag">832</span> <span class="selector-tag">57</span><span class="selector-class">.6MB</span>/<span class="selector-tag">s</span>   <span class="selector-tag">in</span> <span class="selector-tag">3</span><span class="selector-class">.1s</span>   </span><br><span class="line"></span><br><span class="line"><span class="selector-tag">2021-03-19</span> <span class="selector-tag">11</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:09</span> (<span class="number">57.6</span> MB/s) <span class="selector-tag">-</span> ‘<span class="selector-tag">jdk-8u181-linux-x64</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span>’ <span class="selector-tag">saved</span> <span class="selector-attr">[185646832/185646832]</span></span><br><span class="line"><span class="selector-attr">[root@centos local]</span># <span class="selector-tag">tar</span> <span class="selector-tag">zxvf</span> <span class="selector-tag">jdk-8u181-linux-x64</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure>

<p>配置环境变量</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@centos local]# vi /etc/profile</span><br><span class="line">输入大写的G,到达文本的最后,输入i进入编辑模式加入以下配置,按esc键盘退出编辑模式,输入:wq保存并退出</span><br><span class="line"><span class="attribute">JAVA_HOME</span>=/usr/local/jdk1.8.0_181</span><br><span class="line"><span class="attribute">CLASSPATH</span>=<span class="variable">$CLASSPATH</span>:$JAVA_HOME/lib/</span><br><span class="line"><span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$JAVA_HOME/bin</span><br><span class="line">[root@centos local]# source /etc/profile</span><br><span class="line">[root@centos local]# java -version</span><br><span class="line">java version <span class="string">"1.8.0_181"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_181-b13)</span><br><span class="line">Java HotSpot(TM) 64-Bit<span class="built_in"> Server </span>VM (build 25.181-b13, mixed mode)</span><br></pre></td></tr></table></figure>

<h3 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h3><p>官网下载地址</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//mi</span>rrors.bfsu.edu.cn<span class="regexp">/apache/</span><span class="regexp">/jmeter/</span>source<span class="regexp">/</span></span><br></pre></td></tr></table></figure>

<p>下载</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/apache/</span>jmeter<span class="regexp">/binaries/</span>apache-jmeter-<span class="number">5.2</span>.zip</span><br></pre></td></tr></table></figure>

<p>解压jmeter包,进入apache-jmeter-5.2\bin目录双击jmeter.bat</p>
<img src="\image\image-20210312165019995.png">

<p>界面更改语言为简体中文(此次生效)<br><img src="\image\image-20210312165057251.png"></p>
<p>修改jmeter.properties文件中的#language=en为language=zh_CN,就可以实现永久中文界面了</p>
<h4 id="虚拟用户压测"><a href="#虚拟用户压测" class="headerlink" title="虚拟用户压测"></a>虚拟用户压测</h4><p>添加线程组</p>
<img src="\image\image-20210312165142531.png">

<p>配置线程数和时间</p>
<img src="\image\image-20210315160425834.png">

<p>线程数：配置几个就代表有几个虚拟用户</p>
<p>Ramp-Up 时间（秒）:表示从第一个虚拟用户开始生成直到最后一个虚拟用户开始生成的时间，加入配置了5个虚拟用户，Ramp-Up 设置成10s，那么jmeter会每隔2s生成1个虚拟用户，这个选项主要的作用是控制并发的强度，不让虚拟用户在同一时间产生从而对系统造成多大的复杂，Ramp-Up设置成0，那么所有用户将会同时立即产生</p>
<p>循环数：要么是N次，要么是永远</p>
<p>调度器：就是定时执行的设置方式。我们可以设置在未来的某个时间开始执行也可以设置多少秒后开始执行。</p>
<p>添加HTTP请求</p>
<img src="\image\image-20210315161224028.png">

<p>配置请HTTP请求</p>
<img src="\image\image-20210315161618996.png">

<p>添加结果树和聚合报告</p>
<img src="\image\image-20210315161726624.png">

<p>配置HTTP信息头</p>
<img src="\image\image-20210315161937333.png">

<p>执行请求</p>
<img src="\image\image-20210315162059990.png">

<p>聚合报告中可查看到请求总数,异常数,吞吐量等</p>
<p>查看结果树中可查看到请求的接口返回结果</p>
<img src="\image\image-20210315162241338.png">

<p>点击清除按钮,清除上次执行请求的结果</p>
<img src="\image\image-20210315162344364.png">

<p>保存测试计划,保存后格式为jmx</p>
<img src="\image\image-20210315162551652.png">

<h4 id="真实用户参数化压测"><a href="#真实用户参数化压测" class="headerlink" title="真实用户参数化压测"></a>真实用户参数化压测</h4><p>模拟多用户请求</p>
<img src="\image\image-20210318145516123.png">

<p>配置CSV数据文件</p>
<img src="\image\image-20210318145657948.png">

<p>在<strong>浏览</strong>中引入定义的CSV文件,指定文件的编码格式为UTF-8,定义变量名{phone,code},变量名称个数与CSV中的列数相对应,变量名以逗号分隔</p>
<p>CSV数据示例</p>
<img src="\image\image-20210318145932235.png">

<p>更改HTTP请求中的请求数据为参数化,把请求的手机号和二维码信息配置为上面定义的参数,参数格式为<strong>${参数}</strong></p>
<img src="\image\image-20210318150323783.png">

<p>添加表格查看结果</p>
<img src="\image\image-20210318150700170.png">

<p>压测请求后,可看到具体请求时间,请求时间,连接大小等参数</p>
<img src="\image\image-20210318150630922.png">

<h4 id="修改jmeter启动内存"><a href="#修改jmeter启动内存" class="headerlink" title="修改jmeter启动内存"></a>修改jmeter启动内存</h4><p>修改jmeter.bat文件</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修改前:</span><br><span class="line"><span class="attribute">HEAP</span>=-Xms1g -Xmx1g -XX:<span class="attribute">MaxMetaspaceSize</span>=256m</span><br><span class="line">修改后</span><br><span class="line"><span class="attribute">HEAP</span>=-Xms1024m -Xmx2048m -XX:<span class="attribute">MaxMetaspaceSize</span>=600m</span><br></pre></td></tr></table></figure>

<p>启动meter.bat,发现弹窗里出现的还是256m,经检测发现该弹窗内显示的只是引导语,类似欢迎你,是写死的,不是真实的配置</p>
<img src="\image\image-20210318195746254.png">

<p>可使用java中的jconsole(jdk\bin\jconsole.exe)查看真实的内存配置</p>
<img src="\image\image-20210318200420577.png">

<p>连接本地的Jmeter进程,选择VM概要可查看到真实的内存配置</p>
<img src="\image\image-20210318200539443.png">

<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>官网下载地址</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//mi</span>rrors.bfsu.edu.cn<span class="regexp">/apache/</span><span class="regexp">/jmeter/</span>source<span class="regexp">/</span></span><br></pre></td></tr></table></figure>

<p>下载</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/apache/</span>jmeter<span class="regexp">/binaries/</span>apache-jmeter-<span class="number">5.2</span>.zip</span><br></pre></td></tr></table></figure>

<p>解压jmeter包</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">unzip</span> <span class="selector-tag">apache-jmeter-5</span><span class="selector-class">.2</span><span class="selector-class">.zip</span></span><br></pre></td></tr></table></figure>

<p>配置环境变量</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#编辑系统环境变量</span></span><br><span class="line">[root<span class="meta">@centos</span> ~]<span class="comment"># vi /etc/profile</span></span><br><span class="line"><span class="comment">#使用快捷键 shift+g 到最后一行,加入以下配置</span></span><br><span class="line"><span class="comment">#JMETER_HOME为jmeter解压目录</span></span><br><span class="line"></span><br><span class="line">export JMETER_HOME=/usr/local/apache-jmeter-5.2</span><br><span class="line">export CLASSPATH=$JMETER_HOME/lib/ext/ApacheJMeter_core.jar:$JMETER_HOME/lib/jorphan.jar:$CLASSPATH</span><br><span class="line">export PATH=$JMETER_HOME/bin:$PATH</span><br><span class="line"></span><br><span class="line"><span class="comment">#使加入的环境变量生效</span></span><br><span class="line">[root<span class="meta">@centos</span> ~]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看jmeter版本,验证安装成功</span></span><br><span class="line">[root<span class="meta">@centos</span> ~]<span class="comment"># jmeter -v</span></span><br><span class="line">Mar 12, 2021 11:40:02 AM java.util.prefs.FileSystemPreferences$1 run</span><br><span class="line">INFO: Created user preferences directory.</span><br><span class="line">    _    ____   _    ____ _   _ _____       _ __  __ _____ _____ _____ ____</span><br><span class="line">   / \  |<span class="string">  _ \ / \  / ___</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> ____</span>|<span class="string">     </span>|<span class="string"> </span>|<span class="string">  \/  </span>|<span class="string"> ____</span>|<span class="string">_   _</span>|<span class="string"> ____</span>|<span class="string">  _ \</span></span><br><span class="line"><span class="string">  / _ \ </span>|<span class="string"> </span>|<span class="string">_) / _ \</span>|<span class="string"> </span>|<span class="string">   </span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">  _</span>|<span class="string">    _  </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">\/</span>|<span class="string"> </span>|<span class="string">  _</span>|<span class="string">   </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">  _</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">_) </span>|</span><br><span class="line"> / ___ \|<span class="string">  __/ ___ \ </span>|<span class="string">___</span>|<span class="string">  _  </span>|<span class="string"> </span>|<span class="string">___  </span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">  </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">___  </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">___</span>|<span class="string">  _ &lt;</span></span><br><span class="line"><span class="string">/_/   \_\_</span>|<span class="string"> /_/   \_\____</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string">_____</span>|<span class="string">  \___/</span>|<span class="string">_</span>|<span class="string">  </span>|<span class="string">_</span>|<span class="string">_____</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_____</span>|<span class="string">_</span>|<span class="string"> \_\ 5.2</span></span><br><span class="line"></span><br><span class="line"><span class="string">Copyright (c) 1999-2019 The Apache Software Foundation</span></span><br></pre></td></tr></table></figure>

<p>上传windows保存的测试计划.jmx文件到jmeter的bin目录下</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">root@</span><span class="string">centos </span><span class="string">bin]</span><span class="comment"># pwd</span></span><br><span class="line">/<span class="string">home/</span><span class="string">apache-jmeter-</span>5.2/<span class="string">bin</span></span><br><span class="line"><span class="string">[</span><span class="string">root@</span><span class="string">centos </span><span class="string">bin]</span><span class="comment"># ls</span></span><br><span class="line"><span class="string">ApacheJMeter.</span><span class="string">jar </span>         <span class="built_in">create-rmi-keystore.sh</span>  <span class="string">jaas.</span><span class="string">conf </span>                  <span class="string">jmeter.</span><span class="string">properties </span> <span class="string">krb5.</span><span class="string">conf </span>                  <span class="string">report-template </span>        <span class="string">stoptest.</span><span class="string">sh </span>        <span class="string">user.</span><span class="string">properties</span></span><br><span class="line"><span class="string">BeanShellAssertion.</span><span class="string">bshrc </span> <span class="string">examples </span>               <span class="string">jdk-8u281-</span><span class="string">linux-x64.</span><span class="string">tar.</span><span class="string">gz </span> <span class="string">jmeter-server </span>     <span class="string">log4j2.</span><span class="string">xml </span>                 <span class="string">rmi_keystore.</span><span class="string">jks </span>       <span class="string">system.</span><span class="string">properties </span>  <span class="string">utility.</span><span class="string">groovy</span></span><br><span class="line"><span class="string">BeanShellFunction.</span><span class="string">bshrc </span>  <span class="string">hc.</span><span class="string">parameters </span>          <span class="string">jmeter </span>                     <span class="string">jmeter-server.</span><span class="string">bat </span> <span class="string">mirror-server </span>              <span class="string">saveservice.</span><span class="string">properties </span> <span class="string">templates </span>          <span class="string">wget-log</span></span><br><span class="line"><span class="string">BeanShellListeners.</span><span class="string">bshrc </span> <span class="string">heapdump.</span><span class="string">cmd </span>           <span class="string">jmeter.</span><span class="string">bat </span>                 <span class="string">jmeter.</span><span class="string">sh </span>         <span class="string">mirror-server.</span><span class="string">cmd </span>          <span class="string">shutdown.</span><span class="string">cmd </span>           <span class="string">threaddump.</span><span class="string">cmd</span></span><br><span class="line"><span class="string">BeanShellSampler.</span><span class="string">bshrc </span>   <span class="string">heapdump.</span><span class="string">sh </span>            <span class="string">jmeter-n.</span><span class="string">cmd </span>               <span class="string">jmeter-t.</span><span class="string">cmd </span>      <span class="string">mirror-server.</span><span class="string">sh </span>           <span class="string">shutdown.</span><span class="string">sh </span>            <span class="string">threaddump.</span><span class="string">sh</span></span><br><span class="line"><span class="string">create-</span><span class="string">rmi-keystore.</span><span class="string">bat </span>  <span class="string">HttpRequest.</span><span class="string">jmx </span>        <span class="string">jmeter-n-</span>r.<span class="string">cmd </span>             <span class="string">jmeterw.</span><span class="string">cmd </span>       <span class="string">reportgenerator.</span><span class="string">properties </span> <span class="string">stoptest.</span><span class="string">cmd </span>           <span class="string">upgrade.</span><span class="string">properties</span></span><br></pre></td></tr></table></figure>

<p>执行测试计划</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@centos bin]# jmeter -n -t HttpRequest.jmx -l request.log</span><br><span class="line">Creating summariser &lt;summary&gt;</span><br><span class="line">Created the tree successfully using HttpRequest.jmx</span><br><span class="line">Starting standalone test @ Mon Mar 15 16:34:43 CST 2021 (1615797283522)</span><br><span class="line">Waiting <span class="keyword">for</span> possible Shutdown/StopTestNow/HeapDump/ThreadDump message on<span class="built_in"> port </span>4445</span><br><span class="line">summary =     10 <span class="keyword">in</span> 00:00:02 =    5.3/s Avg:  1490 Min:  1343 Max:  1636 Err:     0 (0.00%)</span><br><span class="line">Tidying up <span class="built_in">..</span>.    @ Mon Mar 15 16:34:46 CST 2021 (1615797286014)</span><br><span class="line"><span class="built_in">..</span>. end of run</span><br><span class="line"></span><br><span class="line"><span class="comment">#因jmx文件和执行命令相同,故无须指定jmx的绝对路径,当执行命令与jmx不在同一目录下时,需要指定绝对路径</span></span><br><span class="line"><span class="comment">#-n：以NoGUI方式运行脚本 -t：后面接脚本名称 -l：后面接日志名称，保存运行结果</span></span><br><span class="line"><span class="comment">#注意：客户端和服务器的Jmeter版本最好保持一致，不然运行脚本时会报错</span></span><br><span class="line"><span class="comment">#-l后的文件后缀可随意取名,建议以jtl结尾</span></span><br></pre></td></tr></table></figure>

<p>查看结果</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@centos bin]<span class="comment"># cat request.log </span></span><br><span class="line">timeStamp,elapsed,label,responseCode,responseMessage,threadName,dataType,success,failureMessage,bytes,sentBytes,grpThreads,allThreads,URL,Latency,IdleTime,Connect</span><br><span class="line"><span class="number">1615797284375</span>,<span class="number">1343</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">10</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">10</span>,<span class="number">10</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1340</span>,<span class="number">0</span>,<span class="number">1009</span></span><br><span class="line"><span class="number">1615797284375</span>,<span class="number">1378</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">9</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">9</span>,<span class="number">9</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1377</span>,<span class="number">0</span>,<span class="number">999</span></span><br><span class="line"><span class="number">1615797284375</span>,<span class="number">1406</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">2</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">8</span>,<span class="number">8</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1406</span>,<span class="number">0</span>,<span class="number">1004</span></span><br><span class="line"><span class="number">1615797284371</span>,<span class="number">1412</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">7</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">7</span>,<span class="number">7</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1412</span>,<span class="number">0</span>,<span class="number">1013</span></span><br><span class="line"><span class="number">1615797284375</span>,<span class="number">1504</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">4</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">6</span>,<span class="number">6</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1504</span>,<span class="number">0</span>,<span class="number">1008</span></span><br><span class="line"><span class="number">1615797284389</span>,<span class="number">1513</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">1</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">5</span>,<span class="number">5</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1513</span>,<span class="number">0</span>,<span class="number">990</span></span><br><span class="line"><span class="number">1615797284388</span>,<span class="number">1517</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">6</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">4</span>,<span class="number">4</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1516</span>,<span class="number">0</span>,<span class="number">992</span></span><br><span class="line"><span class="number">1615797284388</span>,<span class="number">1578</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">8</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">3</span>,<span class="number">3</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1578</span>,<span class="number">0</span>,<span class="number">995</span></span><br><span class="line"><span class="number">1615797284373</span>,<span class="number">1619</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">5</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">2</span>,<span class="number">2</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1619</span>,<span class="number">0</span>,<span class="number">1005</span></span><br><span class="line"><span class="number">1615797284375</span>,<span class="number">1636</span>,HTTP请求,<span class="number">200</span>,,线程组 <span class="number">1</span>-<span class="number">3</span>,text,true,,<span class="number">816</span>,<span class="number">357</span>,<span class="number">1</span>,<span class="number">1</span>,https:<span class="regexp">//</span>nmk0718.com<span class="regexp">/host-api/</span>v3_0<span class="regexp">/login/</span>VerificationCodeLogin,<span class="number">1636</span>,<span class="number">0</span>,<span class="number">1007</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可以看到responseCode这一列都是200,代表请求成功</span></span><br></pre></td></tr></table></figure>

<p>查看聚合报告</p>
<p>把request.log下载到桌面,添加一个新的聚合报告,导入request.log即可看到聚合报告</p>
<img src="\image\image-20210315164725351.png">

<p>查看请求结果</p>
<p>从linux导出的文件,是看不到请求返回的数据的</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@centos bin]# pwd</span><br><span class="line">/home/apache-jmeter<span class="number">-5.2</span>/bin</span><br><span class="line">[root@centos bin]# vi jmeter.properties </span><br><span class="line">修改前:</span><br><span class="line">#jmeter.<span class="built_in">save</span>.saveservice.response_data=<span class="keyword">false</span></span><br><span class="line">#jmeter.<span class="built_in">save</span>.saveservice.samplerData=<span class="keyword">false</span></span><br><span class="line"></span><br><span class="line">修改后:</span><br><span class="line">jmeter.<span class="built_in">save</span>.saveservice.response_data=<span class="keyword">true</span></span><br><span class="line">jmeter.<span class="built_in">save</span>.saveservice.samplerData=<span class="keyword">true</span></span><br><span class="line"></span><br><span class="line">[root@centos bin]# vi user.properties </span><br><span class="line">#在文件的最后面加入以下配置</span><br><span class="line">jmeter.<span class="built_in">save</span>.saveservice.output_format=xml</span><br><span class="line">jmeter.<span class="built_in">save</span>.saveservice.response_data=<span class="keyword">true</span></span><br><span class="line">jmeter.<span class="built_in">save</span>.saveservice.samplerData=<span class="keyword">true</span></span><br><span class="line">jmeter.<span class="built_in">save</span>.saveservice.requestHeaders=<span class="keyword">true</span></span><br><span class="line">jmeter.<span class="built_in">save</span>.saveservice.url=<span class="keyword">true</span></span><br><span class="line">jmeter.<span class="built_in">save</span>.saveservice.responseHeaders=<span class="keyword">true</span></span><br></pre></td></tr></table></figure>

<p>再重新执行脚本</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@centos bin]<span class="comment"># jmeter -n -t HttpRequest.jmx -l request.jtl</span></span><br><span class="line">Creating summariser &lt;summary&gt;</span><br><span class="line">Created the tree successfully using HttpRequest.jmx</span><br><span class="line">Starting standalone test @ Fri Mar<span class="number"> 19 </span>15:51:56 CST<span class="number"> 2021 </span>(1616140316075)</span><br><span class="line">Waiting for possible Shutdown/StopTestNow/HeapDump/ThreadDump message on port 4445</span><br><span class="line">summary +    <span class="number"> 45 </span>in 00:00:03 =   13.8/s Avg: <span class="number"> 2299 </span>Min: <span class="number"> 2061 </span>Max: <span class="number"> 2663 </span>Err:    <span class="number"> 0 </span>(0.00%) Active:<span class="number"> 56 </span>Started:<span class="number"> 100 </span>Finished: 44</span><br><span class="line">summary +    <span class="number"> 55 </span>in 00:00:01 =   63.7/s Avg: <span class="number"> 3070 </span>Min: <span class="number"> 2649 </span>Max: <span class="number"> 3478 </span>Err:    <span class="number"> 0 </span>(0.00%) Active:<span class="number"> 0 </span>Started:<span class="number"> 100 </span>Finished: 100</span><br><span class="line">summary =   <span class="number"> 100 </span>in 00:00:04 =   24.2/s Avg: <span class="number"> 2723 </span>Min: <span class="number"> 2061 </span>Max: <span class="number"> 3478 </span>Err:    <span class="number"> 0 </span>(0.00%)</span><br><span class="line">Tidying up ...    @ Fri Mar<span class="number"> 19 </span>15:52:00 CST<span class="number"> 2021 </span>(1616140320872)</span><br><span class="line">... end of run</span><br></pre></td></tr></table></figure>

<p>在windows查看结果树</p>
<img src="\image\image-20210319155449953.png">

<p>导入request.jtl文件,即可看到请求的响应数据</p>
<img src="\image\image-20210319155539610.png">
        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>nmk</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://nmk0718.github.io/2021/03/27/Jmeter/">http://nmk0718.github.io/2021/03/27/Jmeter/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2020 <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tag/Jmeter/"># Jmeter</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/03/27/Flutter/">Flutter</a>
            
            
            <a class="next" rel="next" href="/2021/03/27/LogView/">LogView</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© nmk | Powered by <a href="https://hexo.io" target="_blank">Hexo</a></span>
	</div>
</footer>

    </div>
</body>
</html>
