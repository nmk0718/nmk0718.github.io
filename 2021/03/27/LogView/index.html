<!DOCTYPE html>
<html lang>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="kk">





<title>LogView</title>



    <link rel="icon" href="/favicon.png">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    

</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">kk&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/app">App</a>
                
                    <a class="menu-item" href="/map">Map</a>
                
                    <a class="menu-item" href="/game">Game</a>
                
                    <a class="menu-item" href="/media">Media</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">kk&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/app">App</a>
                
                    <a class="menu-item" href="/map">Map</a>
                
                    <a class="menu-item" href="/game">Game</a>
                
                    <a class="menu-item" href="/media">Media</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">LogView</h1>
            
                <div class="post-meta">
                    

                    
                        <span class="post-time">
                        Date: <a href="#">2021-03-27&nbsp;&nbsp;14:05</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>1.登录阿里云<br>登录地址：<a href="https://signin.aliyun.com/login.htm#/main" target="_blank" rel="noopener">https://signin.aliyun.com/login.htm#/main</a>  </p>
<h5 id="实时日志"><a href="#实时日志" class="headerlink" title="实时日志"></a>实时日志</h5><img src="\image\image-20210224153302900.png">

<p>生产集群 liangjian-prod</p>
<img src="\image\image-20210224153409185.png">

<p>无状态&gt;对应服务</p>
<img src="\image\image-20210224153503908.png">

<p>查看到有两个日志选项</p>
<img src="\image\image-20210224153630926.png">

<p><code>触发器</code>旁的<strong>日志</strong>可查看500行,不支持自动刷新</p>
<p><img src="\image\image-20210224153904216.png"><code>详情</code>旁的<strong>日志</strong>可查看200行,支持自动刷新</p>
<img src="\image\image-20210224153951254.png">

<h5 id="历史日志"><a href="#历史日志" class="headerlink" title="历史日志"></a>历史日志</h5><img src="\image\image-20210224153320967.png">

<p>liangjian_prod</p>
<img src="\image\image-20210224154056234.png">

<p>选择对应的服务即可查找到日志</p>
<img src="\image\image-20210224154142147.png">

<p>通过时间过滤日志</p>
<img src="\image\image-20210224154230642.png">

<p>关键词搜索,查找<strong>开年大吉</strong></p>
<img src="\image\image-20210224154807352.png">

<p>上图中出现了<strong>出参请求流水</strong> 查询出参流水字段</p>
<img src="\image\image-20210224155037661.png">

<p>结果什么都没返回,在<strong>出参请求流水</strong>后加上*,可查找到, 这是因为日志的分词问题,⚠️注意观察下图字段的红色横线</p>
<p>它把红色横线中的(出参请求流水-出参:) 当作了一个字段,所以匹配搜索不到,这时候就需要加*进行模糊匹配</p>
<img src="\image\image-20210224155154773.png">

<p>也可以通过增加分词,再进行查询</p>
<img src="\image\image-20210224173240145.png">

<p>在对应输出的字段的分词中增加所需要的分词,此处增加为中文：和中文，</p>
<img src="\image\image-20210224173341635.png">

<p>再次查询发现,分词成功</p>
<img src="\image\image-20210224173509000.png">

<p>查找<strong>开年大吉</strong>和<strong>女性专场</strong></p>
<img src="\image\image-20210224155720883.png">

<p>查找<strong>开年大吉</strong>或<strong>陈红</strong></p>
<img src="\image\image-20210224155913802.png">

<p>查找<strong>开年大吉</strong>不包含<strong>陈红</strong></p>
<img src="\image\image-20210224160005711.png">

<p>具体可查看以下运算符或访问阿里云帮助文档：<a href="https://help.aliyun.com/document_detail/29060.html?spm=a2c4g.11186623.6.829.f44f672c3F2old" target="_blank" rel="noopener">https://help.aliyun.com/document_detail/29060.html?spm=a2c4g.11186623.6.829.f44f672c3F2old</a></p>
<table>
<thead>
<tr>
<th align="left">运算符</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">and</td>
<td align="left">and运算符。例如<code>request_method:GET and status:200</code>。如果多个关键词之间没有语法关键词，默认为and关系，例如<code>GET 200 cn-shanghai</code>等同于<code>GET and 200 and cn-shanghai</code>。</td>
</tr>
<tr>
<td align="left">or</td>
<td align="left">or运算符。例如<code>request_method:GET or status:200</code>。</td>
</tr>
<tr>
<td align="left">not</td>
<td align="left">not运算符。例如<code>request_method:GET not status:200</code>、<code>not status:200</code>。</td>
</tr>
<tr>
<td align="left">( )</td>
<td align="left">用于提高括号内查询条件的优先级。例如<code>(request_method:GET or request_method:POST) and status:200</code>。</td>
</tr>
<tr>
<td align="left">:</td>
<td align="left">用于字段查询（Key:Value），例如<code>request_method:GET</code>。如果字段名称或者字段值内有空格、冒号（:）等保留字符，请使用双引号（””）包裹字段名称或者字段值，例如<code>&quot;file info&quot;:apsara</code>。</td>
</tr>
<tr>
<td align="left">“”</td>
<td align="left">使用双引号（””）包裹一个语法关键词，可以将该语法关键词转换成普通字符。例如<code>&quot;and&quot;</code>表示查询包含and的日志，此处的and不代表运算符。在字段查询中双引号（””）内的所有词被当成一个整体。</td>
</tr>
<tr>
<td align="left">\</td>
<td align="left">转义符号，用于转义双引号（””），转义后的引号表示符号本身。例如日志内容为<code>instance_id:nginx&quot;01&quot;</code>，您可以使用<code>instance_id:nginx\&quot;01\&quot;</code>进行查询。</td>
</tr>
<tr>
<td align="left">*</td>
<td align="left">通配符查询，匹配零个、单个、多个字符。例如<code>host:www.yl.mo*k.com</code>。<strong>说明</strong> 日志服务会在所有日志中为您查询到符合条件的100个词，返回包含这100个词并满足查询条件的所有日志。</td>
</tr>
<tr>
<td align="left">?</td>
<td align="left">通配符查询，匹配单个字符。例如<code>host:www.yl.mo?k.com</code>。</td>
</tr>
<tr>
<td align="left">&gt;</td>
<td align="left">查询某字段的值大于某数值的日志。例如<code>request_time&gt;100</code>。</td>
</tr>
<tr>
<td align="left">&gt;=</td>
<td align="left">查询某字段的值大于或等于某数值的日志。例如<code>request_time&gt;=100</code>。</td>
</tr>
<tr>
<td align="left">&lt;</td>
<td align="left">查询某字段的值小于某数值的日志。例如<code>request_time&lt;100</code>。</td>
</tr>
<tr>
<td align="left">&lt;=</td>
<td align="left">查询某字段的值小于或等于某数值的日志。例如<code>request_time&lt;=100</code>。</td>
</tr>
<tr>
<td align="left">=</td>
<td align="left">查询某字段的值等于某数值的日志。针对double、long类型的字段，等号（=）和冒号（:）作用相同。例如<code>request_time=100</code>等同于<code>request_time:100</code>。</td>
</tr>
<tr>
<td align="left">in</td>
<td align="left">查询某字段的值处于某数值范围内的日志，中括号表示闭区间，小括号表示开区间，两个数字之间使用空格分隔。例如<code>request_time in [100 200]</code>或<code>request_time in (100 200]</code>。<strong>说明</strong> in只能为小写字母。</td>
</tr>
<tr>
<td align="left"><strong><strong>source</strong></strong></td>
<td align="left">查询某个日志源的日志，支持通配符。例如<code>__source__:&quot;192.0.2.*&quot;</code>。<strong>注意</strong> 日志服务中的<strong><strong>source</strong></strong>为保留字段，可缩写为<strong>source</strong>。如果您自定义的字段中存在<strong>source</strong>字段，则会与日志服务保留字段<strong>source</strong>冲突，此时您需要使用<strong>Source</strong>、<strong>SOURCE</strong>等词查询自定义的字段。</td>
</tr>
<tr>
<td align="left"><strong><strong>tag</strong></strong></td>
<td align="left">通过元数据信息查询日志。例如<code>__tag__:__receive_time__:1609837139</code>。</td>
</tr>
<tr>
<td align="left"><strong><strong>topic</strong></strong></td>
<td align="left">查询某日志主题下的日志。例如<code>__topic__:nginx_access_log</code>。</td>
</tr>
</tbody></table>
<p>上下文浏览</p>
<img src="\image\image-20210224160609787.png">

<p>点击上下文浏览,往上滚动可查看当前日志的前几条日志,往下滚动可查看当前日志的后几条日志,可选择<code>高亮字符串</code>和<code>过滤条件</code></p>
<img src="\image\image-20210224160751446.png">

<p>可把常用的查询语句保存为快速查询</p>
<img src="\image\image-20210224163256372.png">

<p>设置对应的查询名称</p>
<img src="\image\image-20210224163327355.png">

<p>下次可直接在快速查询中直接查看,无需再手动编写语句</p>
<img src="\image\image-20210224163618059.png">

<p>可通过另存为告警进行告警通知该项目负责人(此为示例,通常设置查询信息为error进行过滤)</p>
<img src="\image\image-20210224170527703.png">

<p>配置仪表盘等信息</p>
<img src="\image\image-20210224170812824.png">

<p>告警通知选择钉钉</p>
<img src="\image\image-20210224171054017.png">

<p>WebHook地址为钉钉群组中的WebHook地址</p>
<img src="\image\image-20210224171141251.png">

<p>在下方设置<strong>关键词</strong>.要与配置的告警信息一致,否则会出现通知失败</p>
<img src="\image\image-20210224172650615.png">

<p>因设置间隔为5分钟,5分钟后钉钉群组收到告警信息</p>
<img src="\image\image-20210224172147596.png">

<p>可查看告警次数和告警历史</p>
<img src="\image\image-20210224172517286.png">

<p>告警表达式可参考阿里云帮助文档：<a href="https://help.aliyun.com/document_detail/98379.html?spm=5176.2020520112.0.dexternal.7ec034c0CHYDNp" target="_blank" rel="noopener">https://help.aliyun.com/document_detail/98379.html?spm=5176.2020520112.0.dexternal.7ec034c0CHYDNp</a></p>

        </div>

        
            <section class="post-copyright">
                
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tag/log/"># log</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">Back</a>
                <span>· </span>
                <a href="/">Home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/03/27/Jmeter/">Jmeter</a>
            
            
            <a class="next" rel="next" href="/2020/11/30/Windows软件/">Windows软件</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© kk | Powered by <a href="https://hexo.io" target="_blank">Hexo</a></span>
    </div>
</footer>

    </div>
</body>
</html>
