<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>容器维护 | K&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 4.2.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">nimingkun&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">nimingkun&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">容器维护</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">nmk</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">2020-7-30&nbsp;&nbsp;23:40:00</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/category/deployment/">deployment</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>查看集群</p>
<p>图中有三个集群,集群区域为华北2 状态运行中,节点数为每个集群的worker数.<br><img src="http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-15/5f0e9d826971d.png" alt=""></p>
<details>
<summary>集群扩容</summary>
选择 更多>集群扩容 来为集群扩容节点
也可选择 更多>添加已有节点 来扩容(把ecs添加到集群)
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-15/5f0e9e447e472.png)
选择 专有网络和交换机 付费方式
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-15/5f0e9ecc9358f.png)
选择扩容节点数和规格(规格>内存型>ecs.r5.xlarge)  设置密码提交即可
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-15/5f0ea01d29a2e.png)</details>

<h4 id="节点详情"><a href="#节点详情" class="headerlink" title="节点详情"></a>节点详情</h4><p>图中test集群有两个worker节点,可查看对应的ip地址 计费方式 内存大小 到期时间 内存CPU使用<br>如需更细微的监控,请点击右边的监控可查看负载网络等情况<br>移除worker节点：更多&gt;移除 即可,如需批量移除,请勾选worker节点的选项,点击批量移除即可<br><img src="http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fb71a27871.png" alt=""></p>
<h4 id="无状态"><a href="#无状态" class="headerlink" title="无状态"></a>无状态</h4><p>可查看应用数量,容器数量显示应用的节点数和状态<br>🌰举例:1/1代表1个节点启动成功.0/1代表1个节点但启动失败.1/2代表2个节点但只有一个启动成功<br><img src="http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fb998b34c9.png" alt=""></p>
<details>
  <summary>💁🏻<font color="blue">详情</font></summary>
查看应用名称,应用的来源(镜像仓库地址),应用的状态,pod的ip,pod所在worker的ip 创建时间![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fbb19e1c65.png)
🔎<font color="blue">详情</font>
查看该应用所在pod的资源情况
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fbc63e18cb.png)
📋<font color="blue">日志</font>
选择显示的行数,是否自动刷新日志,可下载日志文件
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fbcb40601f.png)
⚙️<font color="blue">更多</font>
编辑可查看该应用的yaml文件 终端可连接到pod里进行操作 删除可删除当前的pod,但会自动再创建一个
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fbd389d876.png)
🚪访问方式
可查看和编辑 服务代表pod对外映射的端口 路由代表进来的域名地址转发到pod里的应用地址
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fbfd4236f2.png)
🎛容器水平伸缩器
可按照规则进行自动的扩容和减少节点数 最小副本决定该应用的最小节点数
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fbfe8106a7.png)
📷历史版本
出现问题时可使用进行回滚(运维配置该回滚有点问题,请勿使用)
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fc088499a1.png)
🧭触发器
与容器镜像服务的触发器相对应,检测到镜像变化则更新应用
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fc154cd697.png)
</details>


<details>
    <summary>💁🏻<font color="blue">编辑</font></summary>
**镜像名称**: 镜像仓库地址
**镜像Tag**: 镜像的版本
**总是拉取镜像**: 当出现删除或扩容时拉取镜像
**所需资源**: 定义的pod内存和cpu
**资源限制**: pod共享的内存和cpu (此为pod的最大内存和cpu值)
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fc613da038.png)
存活检查
就绪检查
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fc70509928.png)
挂载目录到worker节点(当pod重启时,对应目录的数据会保留)
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fc7d588040.png)
</details>

<details>
    <summary>💁🏻<font color="blue">伸缩</font></summary>
可增加和减少当前应用的节点数(⚠️<font color="red">当配置容器伸缩水平时,当前此配置无效</font>)
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fc3fe369c2.png)
</details>

<details>
    <summary>💁🏻<font color="blue">监控</font></summary>
可查看应用所在容器的监控,<font color="red">分组</font>为整个组的资源使用,<font color="red">实例</font>可查看单个节点的资源使用
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fc3a3b9692.png)
</details>

<details>
    <summary>💁🏻<font color="blue">更多</font></summary>
可查看yaml文件,重新部署应用,回滚到相应版本,删除应用
![](http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fc33ab80b4.png)
</details>

<h4 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h4><p><strong>名称</strong>: 自定义(应用名即可)<br><strong>关联</strong>: 应用的的无状态名称<br><strong>端口映射</strong>: 需要外放的端口<br><img src="http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fee1759024.png" alt=""></p>
<h4 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h4><p><strong>名称</strong>: 自定义(可填写域名名称)<br><strong>域名</strong>: 域名(tdev.gzlplink.com)<br><strong>路径</strong>: 要访问的地址(如/api)<br><strong>服务</strong>: 选择服务对应的容器名<br>勾选开启TLS,使用密钥,既可使用https,如未有密钥可点击新建密钥进行创建<br><img src="http://showdoc.gzlplink.com/server/../Public/Uploads/2020-07-16/5f0fefc2ea532.png" alt=""></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>nmk</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://nmk0718.github.io/2020/07/30/%E5%AE%B9%E5%99%A8%E7%BB%B4%E6%8A%A4/">http://nmk0718.github.io/2020/07/30/%E5%AE%B9%E5%99%A8%E7%BB%B4%E6%8A%A4/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2020 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tag/k8s/"># k8s</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2020/07/30/elasticsearch/">elasticsearch</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© nmk | Powered by <a href="https://hexo.io" target="_blank">Hexo</a></span>
	</div>
</footer>

    </div>
</body>
</html>
